.main
  .container
    .row
      .col-md-6
        .panel
          .panel-body
            = render 'shareds/flash'
            %h2
              = t('.username')
              = @article.user.name
            %h2
              = t('.category')
              = @article.category.try(:name)
            %h2
              = t('.title')
              = @article.title
            %p
              = t('.content')
              = @article.content
            .pull-right 
              - if @article.is_user_like?(current_user)
                = link_to article_like_path(@article), method: :delete, "class" => "like", remote: true do
                  %i.fa.fa-heart
                .span-count
                  = @article.likes.count
              - else
                = link_to article_like_path(@article), method: :post, "class" => "like", remote: true do
                  %i.fa.fa-heart
                .span-count
                  = @article.likes.count
             
              - @article.comments.each do |comment|
                #index
                  %p= comment&.user&.name
                  #div4
                    = comment.created_at.strftime("%Y-%m-%d %H:%M:%S")
                  %h4= comment&.content
                  - if comment.user == current_user
                    = link_to edit_article_comment_path(comment.article, comment) do
                      %i.fa.fa-edit
                    = link_to [comment.article, comment], method: :delete, data: { confirm: "确定删除?" } do
                      %i.fa.fa-trash
                  %h2
                    =@article.comments.count
                    = t('.Comments')
              = simple_form_for([@article, @article.comments.build], remote: true) do |f|
                .form-group
                  = f.label :content, class: "control-label"
                  = f.text_area :content, placeholder: t('.content'), class: "form-control"
                = f.submit t('.create comment'), class: "btn btn-primary", :id => "comment"
                = link_to t('.B'), root_path, class: "btn btn-danger"
              #article
                - if correct_user
                  = link_to edit_article_path(@article) do
                    %i.fa.fa-edit
                
                  = link_to article_path(@article), method: :delete, data: { confirm: "确定删除?" } do
                    %i.fa.fa-trash
